Version 4
SHEET 1 1716 1712
WIRE -160 -608 -320 -608
WIRE 0 -608 -160 -608
WIRE -1392 -560 -1488 -560
WIRE -320 -560 -320 -608
WIRE 0 -560 0 -608
WIRE -1456 -528 -1456 -576
WIRE -1696 -512 -1744 -512
WIRE -1568 -512 -1568 -560
WIRE -1568 -512 -1616 -512
WIRE -1488 -512 -1568 -512
WIRE -160 -512 -256 -512
WIRE -64 -512 -160 -512
WIRE -1392 -496 -1392 -560
WIRE -1392 -496 -1424 -496
WIRE -1120 -496 -1392 -496
WIRE 304 -496 304 -528
WIRE 416 -496 416 -528
WIRE -1744 -480 -1744 -512
WIRE -1488 -480 -1504 -480
WIRE -1120 -448 -1120 -496
WIRE 720 -448 720 -560
WIRE -320 -432 -320 -464
WIRE -320 -432 -416 -432
WIRE -192 -432 -320 -432
WIRE 0 -432 0 -464
WIRE 0 -432 -128 -432
WIRE 112 -432 0 -432
WIRE -1456 -416 -1456 -464
WIRE -1504 -400 -1504 -480
WIRE -320 -400 -320 -432
WIRE 0 -400 0 -432
WIRE 304 -384 304 -416
WIRE 416 -384 416 -416
WIRE -1744 -352 -1744 -400
WIRE -160 -352 -256 -352
WIRE -64 -352 -160 -352
WIRE -1120 -320 -1120 -368
WIRE 720 -320 720 -368
WIRE 720 -320 608 -320
WIRE -1312 -288 -1376 -288
WIRE -320 -272 -320 -304
WIRE -192 -272 -320 -272
WIRE 0 -272 0 -304
WIRE 0 -272 -128 -272
WIRE 720 -272 720 -320
WIRE -1120 -256 -1120 -320
WIRE -1072 -256 -1088 -256
WIRE -1040 -256 -1072 -256
WIRE -320 -240 -320 -272
WIRE 0 -240 0 -272
WIRE -1520 -224 -1616 -224
WIRE -1088 -224 -1088 -256
WIRE -1040 -224 -1040 -256
WIRE -1584 -192 -1584 -240
WIRE -160 -192 -256 -192
WIRE -64 -192 -160 -192
WIRE -1824 -176 -1984 -176
WIRE -1696 -176 -1696 -224
WIRE -1696 -176 -1744 -176
WIRE -1616 -176 -1696 -176
WIRE -1520 -160 -1520 -224
WIRE -1520 -160 -1552 -160
WIRE -1408 -160 -1520 -160
WIRE -1312 -160 -1408 -160
WIRE -976 -160 -976 -192
WIRE -864 -160 -976 -160
WIRE 720 -160 720 -192
WIRE 720 -160 608 -160
WIRE -1616 -144 -1632 -144
WIRE -976 -144 -976 -160
WIRE -1072 -128 -1072 -256
WIRE -1408 -112 -1408 -160
WIRE -1344 -112 -1408 -112
WIRE -1328 -112 -1344 -112
WIRE -320 -112 -320 -144
WIRE -320 -112 -416 -112
WIRE -208 -112 -320 -112
WIRE 0 -112 0 -144
WIRE 0 -112 -144 -112
WIRE 112 -112 0 -112
WIRE 128 -112 112 -112
WIRE 720 -112 720 -160
WIRE -1824 -80 -1984 -80
WIRE -1632 -80 -1632 -144
WIRE -1632 -80 -1744 -80
WIRE -1584 -80 -1584 -128
WIRE -320 -80 -320 -112
WIRE 0 -80 0 -112
WIRE -1632 -64 -1632 -80
WIRE -160 -32 -256 -32
WIRE -64 -32 -160 -32
WIRE -1072 -16 -1072 -48
WIRE -976 -16 -976 -64
WIRE 720 0 720 -32
WIRE 720 0 608 0
WIRE -320 48 -320 16
WIRE -208 48 -320 48
WIRE 0 48 0 16
WIRE 0 48 -144 48
WIRE 720 48 720 0
WIRE -1680 128 -1680 96
WIRE -1632 128 -1680 128
WIRE -1488 144 -1568 144
WIRE -1632 160 -1648 160
WIRE 720 176 720 128
WIRE 720 176 608 176
WIRE 720 208 720 176
WIRE -320 240 -320 48
WIRE 0 240 0 48
WIRE -1488 272 -1488 144
WIRE -544 288 -576 288
WIRE -432 288 -464 288
WIRE -416 288 -432 288
WIRE -384 288 -416 288
WIRE 128 288 64 288
WIRE 208 288 128 288
WIRE 432 288 272 288
WIRE 432 304 432 288
WIRE -576 336 -576 288
WIRE 720 352 720 288
WIRE -1488 368 -1488 352
WIRE -1488 384 -1488 368
WIRE -1488 384 -1536 384
WIRE -1440 384 -1488 384
WIRE -800 400 -800 -160
WIRE -432 400 -432 288
WIRE -432 400 -800 400
WIRE 128 400 128 368
WIRE 432 416 432 384
WIRE -1952 432 -2128 432
WIRE -1808 432 -1872 432
WIRE -1616 432 -1808 432
WIRE -1600 432 -1616 432
WIRE -1248 432 -1376 432
WIRE -1200 432 -1248 432
WIRE -1056 432 -1120 432
WIRE -320 432 -320 336
WIRE -176 432 -320 432
WIRE 0 432 0 336
WIRE 0 432 -176 432
WIRE -1248 448 -1248 432
WIRE -2128 480 -2128 432
WIRE -1808 496 -1808 432
WIRE -1648 496 -1648 160
WIRE -1616 496 -1648 496
WIRE -1536 496 -1536 480
WIRE -1536 496 -1616 496
WIRE -1536 512 -1536 496
WIRE -1248 544 -1248 528
WIRE -1056 544 -1056 512
WIRE -2128 640 -2128 560
WIRE -1808 640 -1808 576
WIRE -1536 736 -1536 592
WIRE -1440 800 -1440 480
WIRE -1344 800 -1440 800
WIRE -1440 864 -1440 800
WIRE -176 864 -176 432
WIRE -1344 912 -1344 800
WIRE -1344 912 -1376 912
WIRE -240 912 -1344 912
WIRE -1440 1088 -1440 960
WIRE -576 1088 -1440 1088
WIRE -176 1088 -176 960
WIRE -176 1088 -576 1088
FLAG 416 -384 0
FLAG 416 -528 VCC
FLAG 304 -384 0
FLAG 304 -528 VSS
FLAG 432 416 0
FLAG -160 -608 VCC
FLAG -160 -512 VPOL1
FLAG -160 -352 VPOL2
FLAG -160 -192 VPOL3
FLAG -160 -32 VPOL4
FLAG 128 400 0
FLAG -576 336 0
FLAG 720 352 0
FLAG 608 -160 VPOL2
FLAG 608 0 VPOL3
FLAG 608 176 VPOL4
FLAG -416 288 VFB
FLAG 608 -320 VPOL1
FLAG -576 1088 VSS
FLAG -1680 96 0
FLAG -2128 640 0
FLAG -1056 544 0
FLAG -1600 176 VCC
FLAG -1600 112 VSS
FLAG -1616 432 q1b
FLAG -1616 496 aopm
FLAG -1488 368 pairecommun
FLAG -1536 736 VSS
FLAG -1216 -160 VSS
FLAG -1216 -288 VCC
FLAG -976 -16 VSS
FLAG -976 -160 BUF
FLAG -1120 -320 Vabc
FLAG -1504 -400 0
FLAG -1072 -16 0
FLAG -1376 -288 0
FLAG -1456 -416 VSS
FLAG -1456 -576 VCC
FLAG -1744 -352 0
FLAG -1808 640 0
FLAG -1248 544 0
FLAG -1584 -80 VSS
FLAG -1584 -240 VCC
FLAG -1632 16 0
FLAG 720 -560 VCC
FLAG -1344 -112 OTA_IN
FLAG -416 -432 OUT_R_4
FLAG 112 -432 OUT_L_4
FLAG -416 -112 OUT_R_2
FLAG 112 -112 OUT_L_2
FLAG -1984 -176 OUT_L_4
FLAG -1984 -80 OUT_R_4
DATAFLAG -176 432 "$"
DATAFLAG -320 144 "$"
DATAFLAG 0 160 "$"
DATAFLAG 656 -320 "$"
DATAFLAG 656 -160 "$"
DATAFLAG 656 0 "$"
DATAFLAG 656 176 "$"
DATAFLAG -240 -272 "$"
DATAFLAG -240 -112 "$"
DATAFLAG -32 -432 "$"
DATAFLAG -48 -272 "$"
DATAFLAG -48 -112 "$"
DATAFLAG 128 288 "$"
DATAFLAG -1488 144 ""
DATAFLAG -1648 272 ""
DATAFLAG -1440 384 ""
DATAFLAG -2048 432 ""
DATAFLAG -1536 672 ""
DATAFLAG -1344 432 "$"
DATAFLAG -1280 1088 "$"
DATAFLAG -624 912 "$"
DATAFLAG -656 400 "$"
DATAFLAG -1264 -496 "$"
DATAFLAG -1040 -256 "$"
DATAFLAG -1328 -288 "$"
DATAFLAG -1728 432 "$"
DATAFLAG -1888 -176 "$"
DATAFLAG -1888 -80 "$"
DATAFLAG -1408 -160 "$"
SYMBOL voltage 416 -512 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vvcc
SYMATTR Value 5
SYMBOL voltage 304 -512 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vvss
SYMATTR Value -5
SYMBOL voltage 432 288 M0
WINDOW 123 24 118 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName Vin
SYMATTR Value SINE(0 1 100)
SYMBOL npn -256 -560 M0
SYMATTR InstName Q1
SYMBOL npn -64 -560 R0
SYMATTR InstName Q2
SYMBOL npn -256 -400 M0
SYMATTR InstName Q3
SYMBOL npn -64 -400 R0
SYMATTR InstName Q4
SYMBOL npn -256 -240 M0
SYMATTR InstName Q5
SYMBOL npn -64 -240 R0
SYMATTR InstName Q6
SYMBOL npn -256 -80 M0
SYMATTR InstName Q7
SYMBOL npn -64 -80 R0
SYMATTR InstName Q8
SYMBOL npn -384 240 R0
SYMATTR InstName Q9
SYMBOL npn 64 240 M0
SYMATTR InstName Q11
SYMBOL npn -240 864 R0
SYMATTR InstName Qmirror2
SYMBOL res -560 272 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R_IN_BIAS2
SYMATTR Value 1k
SYMBOL res 112 384 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R_IN_BIAS1
SYMATTR Value 1k
SYMBOL res 736 -352 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RPOL1
SYMATTR Value 1k
SYMBOL res 736 -176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RPOL2
SYMATTR Value 1k
SYMBOL res 736 -16 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RPOL3
SYMATTR Value 1k
SYMBOL res 736 144 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RPOL4
SYMATTR Value 1k
SYMBOL res 736 304 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RPOL5
SYMATTR Value 1k
SYMBOL cap 208 272 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName CIN
SYMATTR Value 10µ
SYMBOL cap -208 32 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName CF1
SYMATTR Value {CF12}
SYMBOL cap -208 -128 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName CF2
SYMATTR Value {CF12}
SYMBOL cap -192 -288 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName CF3
SYMATTR Value {CF34}
SYMBOL cap -192 -448 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName CF4
SYMATTR Value {CF34}
SYMBOL npn -1376 864 M0
SYMATTR InstName Qmirror1
SYMBOL LT1358 -1600 208 M180
SYMATTR InstName U1
SYMBOL res -1472 256 M0
SYMATTR InstName Rcom1
SYMATTR Value 220
SYMBOL res -1552 608 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rbias4
SYMATTR Value 150k
SYMBOL pnp -1600 480 M180
WINDOW 0 32 45 Left 2
SYMATTR InstName Qexp1
SYMBOL pnp -1376 480 R180
WINDOW 0 42 39 Left 2
SYMATTR InstName Qexp2
SYMBOL voltage -1056 416 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V_cutoff_bias
SYMATTR Value 15
SYMBOL voltage -2128 464 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V_cutoff_cv
SYMATTR Value 0.8
SYMBOL cap -864 -176 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C_FB
SYMATTR Value 10µ
SYMBOL LM13700 -1248 -304 R0
SYMATTR InstName U2
SYMBOL voltage -1744 -496 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 0 57 Left 2
SYMATTR InstName V_res
SYMATTR Value {CV}
SYMBOL res -960 -48 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R2LM137
SYMATTR Value 1k
SYMBOL res -1056 -32 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R1LM137
SYMATTR Value 10k
SYMBOL res -1104 -352 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R_RES
SYMATTR Value 4k
SYMBOL LT1358 -1456 -560 R0
SYMATTR InstName U3
SYMBOL res -1584 -544 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R_CVRES2
SYMATTR Value 56k
SYMBOL res -1712 -496 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R_CVRES1
SYMATTR Value 10k
SYMBOL res -1968 416 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R_CV2
SYMATTR Value 22k
SYMBOL res -1792 480 M0
SYMATTR InstName R_CV1
SYMATTR Value 2.7k
SYMBOL res -1216 416 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R_CV3
SYMATTR Value 220k
SYMBOL res -1232 432 M0
SYMATTR InstName R_CV4
SYMATTR Value 1.5k
SYMBOL LT1358 -1584 -224 R0
SYMATTR InstName U4
SYMBOL res -1712 -208 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R_DIFF2
SYMATTR Value 10k
SYMBOL res -1840 -160 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R_DIFF1
SYMATTR Value 10k
SYMBOL res -1840 -64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R_DIFF3
SYMATTR Value 10k
SYMBOL res -1648 -80 R0
SYMATTR InstName R_DIFF4
SYMATTR Value 10k
TEXT -832 496 Left 2 !.op\n.tran 20u 50m\n*.AC  DEC  100 20 20k\n*.IC V(OUT)=2.5\n\n*.step temp 20 45 5\n*.step param rm list 1k 10k 100k\n*.step param CV -60m 60m 30m\n.step param CV 0 2 0.2\n*.step param CF34 list 1p 470n\n*.step param RES 22k 23k 200\n* step colors : GREEN BLUE RED CYAN PINK GRAY DARKGREEN DARKBLUE MAROON DARKPINK DARKRED DARKYELLOW (cycle of 12 colours)\n* step param syntax : replace the numerical value by "{CV}" in the parameter of interest (e.g., V_cutoff_cv)\n.param CF12=470n\n.param CF34=470n\n* set CF34 to 1p to simulate a 2nd order filter\n\n.lib lm13700.sub
TEXT -1528 -88 Left 2 ;Variable closed loop gain amplifier
TEXT -2152 112 Left 2 ;This is the exponential converter \nfrom CV  (aka V_cutoff_cv)\nto the mirror current at Qmirror2\nThe point is that the cutoff \nfrequency depends exponentially \non CV as is expected in any\nmusic instrument.\nInput CV typically ranges \nfrom -60mV to 60mV.
TEXT -2176 -720 Left 2 ;Resonance Control Voltage ranges from 0 to 2V at DAC output\nhence we need an OpAmp to convert to the [-11V ; 0V] range.\nMaximum resonance is obtained for 2V, minimum for 0V.\nAdjust R_RES for optimum max resonance.
TEXT -1080 -440 Left 2 ;Optimal value :\n4th order : 15k\n2nd order : 4k
RECTANGLE Normal -2216 68 -916 772 2
RECTANGLE Normal -2212 52 -904 -752 2
